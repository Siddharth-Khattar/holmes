---
phase: 01-foundation-infrastructure
plan: 05
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - frontend/package.json
  - frontend/next.config.ts
  - frontend/tsconfig.json
  - frontend/tailwind.config.ts
  - frontend/src/app/layout.tsx
  - frontend/src/app/page.tsx
  - frontend/src/app/globals.css
  - frontend/src/lib/api.ts
  - frontend/Dockerfile
  - frontend/.env.example
autonomous: true

must_haves:
  truths:
    - "Running 'bun dev' in frontend starts development server on port 3000"
    - "Home page renders with Holmes branding"
    - "TypeScript compilation succeeds with strict mode"
    - "Frontend can import types from @holmes/types"
  artifacts:
    - path: "frontend/package.json"
      provides: "Next.js project configuration"
      contains: "next"
    - path: "frontend/next.config.ts"
      provides: "Next.js configuration with standalone output"
      contains: "standalone"
    - path: "frontend/src/app/page.tsx"
      provides: "Home page component"
      contains: "Holmes"
    - path: "frontend/Dockerfile"
      provides: "Production container image"
      contains: "node server.js"
  key_links:
    - from: "frontend/package.json"
      to: "packages/types"
      via: "workspace dependency"
      pattern: "@holmes/types"
---

<objective>
Create the Next.js frontend skeleton with basic configuration and Docker setup.

Purpose: Establishes the frontend application structure with proper TypeScript configuration and production-ready Docker image.
Output: Running Next.js application with home page, type imports, and deployable container.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-infrastructure/01-CONTEXT.md
@.planning/phases/01-foundation-infrastructure/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js project with Tailwind</name>
  <files>
    - frontend/package.json
    - frontend/next.config.ts
    - frontend/tsconfig.json
    - frontend/tailwind.config.ts
    - frontend/postcss.config.mjs
    - frontend/src/app/globals.css
    - frontend/.env.example
  </files>
  <action>
1. Create frontend directory and initialize Next.js:
- Run: cd frontend && bun create next-app . --typescript --tailwind --eslint --app --src-dir --no-git
- This scaffolds the Next.js project with App Router

2. Update frontend/package.json:
- Add dependency: "@holmes/types": "workspace:*"
- Ensure scripts include: dev, build, start, lint
- Add NEXT_PUBLIC_API_URL to scripts if needed for local dev

3. Update frontend/next.config.ts:
- Set output: 'standalone' for Docker deployment
- Add any rewrites for API proxy in development (optional)

4. Update frontend/tsconfig.json:
- Ensure strict: true
- Add path alias for @holmes/types if not auto-resolved
- Ensure compilerOptions match project standards

5. Update frontend/tailwind.config.ts:
- Use Tailwind v4 CSS-first configuration approach
- Content paths for src directory

6. frontend/src/app/globals.css:
- Tailwind directives (@tailwind base, components, utilities)
- Basic CSS variables for theming

7. frontend/.env.example:
- NEXT_PUBLIC_API_URL=http://localhost:8080
  </action>
  <verify>
- cd frontend && bun install succeeds
- bun dev starts development server on http://localhost:3000
- bun run build succeeds and creates .next/standalone
  </verify>
  <done>
Next.js project initialized with TypeScript, Tailwind, and standalone output configuration.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create home page and API client setup</name>
  <files>
    - frontend/src/app/layout.tsx
    - frontend/src/app/page.tsx
    - frontend/src/lib/api.ts
  </files>
  <action>
1. frontend/src/app/layout.tsx:
- Root layout with html and body tags
- Import globals.css
- Metadata with title "Holmes" and description
- Basic font setup (Inter or system fonts)

2. frontend/src/app/page.tsx:
- Simple home page with:
  - Holmes logo/title
  - Brief tagline: "AI-Powered Legal Intelligence"
  - Placeholder for auth buttons (Phase 2)
- Import HealthResponse from @holmes/types to verify type imports work
- Basic Tailwind styling (centered content, clean design)

3. frontend/src/lib/api.ts:
- API client configuration
- Base URL from NEXT_PUBLIC_API_URL environment variable
- Type-safe fetch wrapper (optional, can be basic for now)
- Export async function checkHealth() that calls /health endpoint
  </action>
  <verify>
- bun dev shows home page with Holmes branding at http://localhost:3000
- TypeScript compiles without errors: bun run build
- Import from @holmes/types works (check page.tsx compilation)
  </verify>
  <done>
Home page renders with Holmes branding and type imports from shared package work.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create production Dockerfile</name>
  <files>
    - frontend/Dockerfile
  </files>
  <action>
Create frontend/Dockerfile (from 01-RESEARCH.md):

```dockerfile
# Dependencies stage
FROM oven/bun:latest AS deps
WORKDIR /app

# Copy workspace files for proper resolution
COPY package.json bun.lockb ./
COPY packages/types/package.json ./packages/types/
COPY frontend/package.json ./frontend/

# Install all dependencies
RUN cd frontend && bun install --frozen-lockfile

# Builder stage
FROM oven/bun:latest AS builder
WORKDIR /app

# Copy installed dependencies
COPY --from=deps /app/node_modules ./node_modules
COPY --from=deps /app/frontend/node_modules ./frontend/node_modules
COPY --from=deps /app/packages ./packages

# Copy source code
COPY frontend ./frontend
COPY packages/types ./packages/types

# Build the application
WORKDIR /app/frontend
RUN bun run build

# Runner stage
FROM node:20-slim AS runner
WORKDIR /app

ENV NODE_ENV=production
ENV PORT=3000
ENV HOSTNAME=0.0.0.0

# Copy standalone output
COPY --from=builder /app/frontend/.next/standalone ./
COPY --from=builder /app/frontend/.next/static ./.next/static
COPY --from=builder /app/frontend/public ./public

EXPOSE 3000

CMD ["node", "server.js"]
```

Note: This Dockerfile needs to be run from the repo root to access packages/types.
Update root Makefile with: build-frontend: docker build -f frontend/Dockerfile -t holmes-frontend .
  </action>
  <verify>
- From repo root: docker build -f frontend/Dockerfile -t holmes-frontend .
- docker run -p 3000:3000 holmes-frontend starts and serves the app
  </verify>
  <done>
Frontend Dockerfile builds successfully and produces working container.
  </done>
</task>

</tasks>

<verification>
1. Development server: `cd frontend && bun dev` starts on port 3000
2. Build succeeds: `bun run build` creates .next/standalone
3. Type import works: page.tsx compiles with @holmes/types import
4. Docker builds: `docker build -f frontend/Dockerfile -t holmes-frontend .` (from root)
5. Container runs: `docker run -p 3000:3000 holmes-frontend` serves the app
</verification>

<success_criteria>
- Next.js 16.x with App Router initialized
- TypeScript strict mode enabled
- Tailwind CSS configured
- Home page shows Holmes branding
- @holmes/types import works
- Standalone output configured for Docker
- Dockerfile builds and runs successfully
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-infrastructure/01-05-SUMMARY.md`
</output>
