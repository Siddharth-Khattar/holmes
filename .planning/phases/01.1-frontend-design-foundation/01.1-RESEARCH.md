# Phase 1.1: Frontend Design Foundation - Research

**Researched:** 2026-01-23
**Domain:** Frontend design system, CSS glassmorphism, typography, scroll animations
**Confidence:** HIGH

## Summary

This research covers the technical implementation of the Holmes landing page design system, focusing on Liquid Glass effects, distinctive serif typography, scroll-triggered animations with Framer Motion (now Motion), and Tailwind CSS v4 theming.

The established approach is:
1. Use **Motion** (formerly Framer Motion) v12+ for React 19 compatible scroll animations via `useScroll`, `useTransform`, and `whileInView`
2. Use **Fraunces** as the primary serif font for its distinctive editorial character and variable font flexibility (weight, optical size, softness, wonk axes)
3. Implement Liquid Glass with Tailwind CSS v4's `backdrop-blur-*` utilities combined with `bg-*/30` opacity backgrounds
4. Structure design tokens using Tailwind v4's `@theme` directive for CSS-first configuration
5. Default to Server Components for landing page sections with Client Components only for interactive elements (scroll animations)

**Primary recommendation:** Install `motion` package (not `framer-motion`), use Fraunces via `next/font/google`, and define all design tokens in a single `@theme` block within globals.css.

## Standard Stack

The established libraries/tools for this domain:

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| motion | ^12.27.0 | Scroll animations, transitions | Evolution of Framer Motion with React 19 support |
| Fraunces | Variable | Primary serif font | Distinctive editorial character, 4 variable axes |
| Tailwind CSS | ^4.x | Styling, glass effects | CSS-first `@theme` directive, native backdrop-filter |
| next/font | Built-in | Font optimization | Zero layout shift, auto self-hosting |

### Supporting
| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| Newsreader | Variable | Alternative serif | If Fraunces feels too quirky, more traditional editorial |
| React Flow | ^12.x | Workflow diagram | If complex node-based diagrams needed |

### Alternatives Considered
| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| motion | framer-motion | framer-motion still works but motion is the current package name |
| Fraunces | Newsreader | Newsreader is more traditional/conservative, less distinctive |
| Custom glass CSS | @casoon/tailwindcss-glass | Plugin adds complexity; native Tailwind sufficient |

**Installation:**
```bash
# In frontend directory
bun add motion
```

No additional font installation needed - Fraunces is available via `next/font/google`.

## Architecture Patterns

### Recommended Project Structure
```
frontend/src/
├── app/
│   ├── globals.css          # @theme design tokens, glass utilities
│   ├── layout.tsx           # Font setup, global providers
│   └── page.tsx             # Landing page (mostly Server Components)
├── components/
│   ├── ui/                  # Reusable primitives (Button, Card, etc.)
│   │   ├── glass-card.tsx   # Liquid Glass card component
│   │   └── index.ts         # Barrel export
│   ├── landing/             # Landing page sections
│   │   ├── hero.tsx
│   │   ├── problem-section.tsx
│   │   ├── solution-section.tsx
│   │   ├── how-it-works.tsx # Client Component for animations
│   │   ├── feature-highlights.tsx
│   │   ├── trust-section.tsx
│   │   ├── cta-section.tsx
│   │   └── footer.tsx
│   └── layout/              # Structural components
│       └── navigation.tsx   # Client Component for scroll effects
└── lib/
    └── animations.ts        # Shared animation variants/utilities
```

### Pattern 1: Server Components for Static Sections
**What:** Keep landing page sections as Server Components by default
**When to use:** For content that doesn't require client-side interactivity
**Example:**
```tsx
// components/landing/hero.tsx (Server Component - no "use client")
import { AnimatedSection } from './animated-section'

export function Hero() {
  return (
    <AnimatedSection>
      <h1 className="font-serif text-6xl">Deduce. Discover. Decide.</h1>
      <p className="text-smoke/80">When you have eliminated the impossible...</p>
    </AnimatedSection>
  )
}
```

### Pattern 2: Client Component Wrapper for Animations
**What:** Wrap Server Components with thin Client Component animation wrappers
**When to use:** When sections need scroll-triggered animations
**Example:**
```tsx
// components/landing/animated-section.tsx
"use client"

import { motion } from "motion/react"
import { ReactNode } from "react"

interface AnimatedSectionProps {
  children: ReactNode
  className?: string
}

export function AnimatedSection({ children, className }: AnimatedSectionProps) {
  return (
    <motion.section
      initial={{ opacity: 0, y: 20 }}
      whileInView={{ opacity: 1, y: 0 }}
      viewport={{ once: true, margin: "-100px" }}
      transition={{ duration: 0.6, ease: "easeOut" }}
      className={className}
    >
      {children}
    </motion.section>
  )
}
```

### Pattern 3: Tailwind v4 Design Tokens
**What:** Define all design tokens using `@theme` directive
**When to use:** For colors, fonts, spacing that generate utility classes
**Example:**
```css
/* globals.css */
@import "tailwindcss";

@theme {
  /* Color palette from CONTEXT.md */
  --color-charcoal: #121218;
  --color-jet: #22333B;
  --color-smoke: #F2F4F3;
  --color-taupe: #A9927D;
  --color-stone: #5E503F;

  /* Glass effect tokens */
  --color-glass-light: rgba(242, 244, 243, 0.08);
  --color-glass-dark: rgba(18, 18, 24, 0.6);

  /* Typography */
  --font-serif: var(--font-fraunces);

  /* Custom shadows for depth */
  --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.12);
  --shadow-glass-hover: 0 12px 40px rgba(0, 0, 0, 0.16);
}

@theme inline {
  --font-serif: var(--font-fraunces);
}
```

### Anti-Patterns to Avoid
- **Using "use client" at page level:** Don't make entire page.tsx a Client Component. Instead, create small Client Component wrappers for interactive parts.
- **Inline animation definitions:** Don't repeat animation configs. Extract to shared variants in `lib/animations.ts`.
- **Heavy backdrop-blur on large elements:** Keep glass effects to nav and cards only, as specified in CONTEXT.md.
- **Using framer-motion package:** Use the newer `motion` package instead for React 19 compatibility.

## Don't Hand-Roll

Problems that look simple but have existing solutions:

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Scroll progress tracking | Manual scroll listeners | `useScroll` from motion | Handles edge cases, performance optimized |
| Scroll-triggered reveals | Intersection Observer manually | `whileInView` prop | Integrated with animation system |
| Value interpolation | Manual math for scroll -> style | `useTransform` from motion | Handles clamping, easing, color interpolation |
| Font loading | Manual preload links | `next/font/google` | Zero layout shift, automatic optimization |
| Theme variables | CSS variables in :root | `@theme` directive | Generates utility classes automatically |
| Workflow diagrams | Custom SVG animations | React Flow (if complex) | Node positioning, edge routing, zoom/pan |

**Key insight:** Motion's hooks (`useScroll`, `useTransform`, `useInView`) handle all the edge cases around scroll position tracking, element visibility, and value interpolation that are tedious to implement correctly from scratch.

## Common Pitfalls

### Pitfall 1: Backdrop-filter Performance
**What goes wrong:** Page jank on scroll when using backdrop-blur on large or many elements
**Why it happens:** backdrop-filter is GPU-intensive; each blurred element creates a compositing layer
**How to avoid:**
- Keep blur values between 8-12px (higher is exponentially more expensive)
- Apply glass effects only to navigation and cards (as per CONTEXT.md)
- Avoid animating elements that have backdrop-filter
- Use `will-change: transform` sparingly on glass elements
**Warning signs:** Frame drops when scrolling past glass elements; mobile devices particularly affected

### Pitfall 2: Animation Jank from Missing "use client"
**What goes wrong:** Hydration errors or animations not working
**Why it happens:** Motion components use hooks that require client-side execution
**How to avoid:**
- Add "use client" directive to any file using `motion.*` components or Motion hooks
- Create small wrapper components rather than making entire pages Client Components
**Warning signs:** React hydration mismatch errors, animations working in dev but not production

### Pitfall 3: Font Flash (FOUT/FOIT)
**What goes wrong:** Brief flash of unstyled or invisible text before font loads
**Why it happens:** Not using next/font properly or missing `display: swap`
**How to avoid:**
- Always use `next/font/google` for Google Fonts
- Apply font via `className` on `<html>` or `<body>` in layout.tsx
- Use `variable: "--font-fraunces"` for CSS variable access
**Warning signs:** Text flicker on page load, layout shift in Core Web Vitals

### Pitfall 4: Scroll Animation Firing Multiple Times
**What goes wrong:** Animations replay every time element enters/exits viewport
**Why it happens:** Missing `viewport: { once: true }` option
**How to avoid:**
- Always use `viewport={{ once: true }}` for reveal animations
- Use `viewport={{ margin: "-100px" }}` to trigger slightly before element is fully visible
**Warning signs:** Animations replaying on scroll up/down

### Pitfall 5: Variable Font Axes Not Applied
**What goes wrong:** Fraunces looks generic, no wonk or softness variation
**Why it happens:** Variable font axes need explicit CSS setup
**How to avoid:**
- Use `font-variation-settings` for SOFT and WONK axes
- Set `font-optical-sizing: auto` for automatic opsz
- Create utility classes for common axis combinations
**Warning signs:** Fraunces looks like any other serif font

## Code Examples

Verified patterns for Holmes landing page implementation:

### Fraunces Font Setup with next/font
```tsx
// layout.tsx
import { Fraunces } from "next/font/google"

const fraunces = Fraunces({
  subsets: ["latin"],
  variable: "--font-fraunces",
  display: "swap",
  // Variable font includes all weights automatically
})

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en" className={fraunces.variable}>
      <body className="font-serif bg-charcoal text-smoke antialiased">
        {children}
      </body>
    </html>
  )
}
```

### Liquid Glass Card Component
```tsx
// components/ui/glass-card.tsx
"use client"

import { motion } from "motion/react"
import { ReactNode } from "react"

interface GlassCardProps {
  children: ReactNode
  className?: string
}

export function GlassCard({ children, className = "" }: GlassCardProps) {
  return (
    <motion.div
      className={`
        bg-glass-light
        backdrop-blur-md
        rounded-2xl
        shadow-glass
        transition-shadow duration-300
        hover:shadow-glass-hover
        ${className}
      `}
      whileHover={{ scale: 1.02 }}
      transition={{ duration: 0.2 }}
    >
      {children}
    </motion.div>
  )
}
```

### Scroll-Triggered Section Reveal with Stagger
```tsx
// components/landing/feature-highlights.tsx
"use client"

import { motion } from "motion/react"

const features = [
  { title: "Agent Decision Graph", description: "Full AI transparency" },
  { title: "Knowledge Graph", description: "Entity/relationship visualization" },
  { title: "Cross-Modal Linking", description: "Automatic connections" },
  { title: "Contradiction Detection", description: "Proactive inconsistency surfacing" },
]

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.15,
      delayChildren: 0.1,
    },
  },
}

const itemVariants = {
  hidden: { opacity: 0, y: 30 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: "easeOut" }
  },
}

export function FeatureHighlights() {
  return (
    <motion.section
      variants={containerVariants}
      initial="hidden"
      whileInView="visible"
      viewport={{ once: true, margin: "-50px" }}
      className="grid grid-cols-2 gap-6"
    >
      {features.map((feature) => (
        <motion.div
          key={feature.title}
          variants={itemVariants}
          className="bg-glass-light backdrop-blur-md rounded-xl p-6"
        >
          <h3 className="text-xl font-semibold text-smoke">{feature.title}</h3>
          <p className="text-smoke/70 mt-2">{feature.description}</p>
        </motion.div>
      ))}
    </motion.section>
  )
}
```

### Parallax Scroll Effect
```tsx
// components/landing/hero.tsx
"use client"

import { motion, useScroll, useTransform } from "motion/react"
import { useRef } from "react"

export function Hero() {
  const ref = useRef(null)
  const { scrollYProgress } = useScroll({
    target: ref,
    offset: ["start start", "end start"],
  })

  // Parallax: background moves slower than foreground
  const backgroundY = useTransform(scrollYProgress, [0, 1], ["0%", "30%"])
  const textY = useTransform(scrollYProgress, [0, 1], ["0%", "15%"])
  const opacity = useTransform(scrollYProgress, [0, 0.5], [1, 0])

  return (
    <section ref={ref} className="relative h-screen overflow-hidden">
      {/* Background layer - moves slowest */}
      <motion.div
        style={{ y: backgroundY }}
        className="absolute inset-0 bg-gradient-to-b from-charcoal to-jet"
      />

      {/* Content layer - moves faster */}
      <motion.div
        style={{ y: textY, opacity }}
        className="relative z-10 flex flex-col items-center justify-center h-full"
      >
        <h1 className="text-7xl font-serif text-smoke">
          Deduce. Discover. Decide.
        </h1>
      </motion.div>
    </section>
  )
}
```

### Workflow Diagram Animation (Sequential Node Activation)
```tsx
// components/landing/how-it-works.tsx
"use client"

import { motion, useInView } from "motion/react"
import { useRef } from "react"

const steps = [
  { id: 1, label: "Upload" },
  { id: 2, label: "Triage" },
  { id: 3, label: "Analysis" },
  { id: 4, label: "Synthesis" },
  { id: 5, label: "Knowledge Graph" },
]

export function HowItWorks() {
  const ref = useRef(null)
  const isInView = useInView(ref, { once: true, margin: "-100px" })

  return (
    <section ref={ref} className="py-24">
      <div className="flex items-center justify-between max-w-4xl mx-auto">
        {steps.map((step, index) => (
          <div key={step.id} className="flex items-center">
            {/* Node */}
            <motion.div
              initial={{ scale: 0, opacity: 0 }}
              animate={isInView ? { scale: 1, opacity: 1 } : {}}
              transition={{
                delay: index * 0.3,
                duration: 0.4,
                type: "spring",
                stiffness: 200,
              }}
              className="w-16 h-16 rounded-full bg-glass-light backdrop-blur-md
                         flex items-center justify-center border border-smoke/10"
            >
              <span className="text-taupe font-semibold">{step.id}</span>
            </motion.div>

            {/* Connection line (except last) */}
            {index < steps.length - 1 && (
              <motion.div
                initial={{ scaleX: 0 }}
                animate={isInView ? { scaleX: 1 } : {}}
                transition={{
                  delay: index * 0.3 + 0.2,
                  duration: 0.3,
                }}
                style={{ originX: 0 }}
                className="w-12 h-0.5 bg-gradient-to-r from-taupe to-stone mx-2"
              />
            )}
          </div>
        ))}
      </div>

      {/* Labels below nodes */}
      <div className="flex items-center justify-between max-w-4xl mx-auto mt-4">
        {steps.map((step, index) => (
          <motion.span
            key={step.label}
            initial={{ opacity: 0, y: 10 }}
            animate={isInView ? { opacity: 1, y: 0 } : {}}
            transition={{ delay: index * 0.3 + 0.1 }}
            className="text-sm text-smoke/70 w-16 text-center"
          >
            {step.label}
          </motion.span>
        ))}
      </div>
    </section>
  )
}
```

### Complete globals.css Design Token Setup
```css
/* frontend/src/app/globals.css */
@import "tailwindcss";

/* Design tokens via @theme directive */
@theme {
  /* Color palette - from CONTEXT.md */
  --color-charcoal: #121218;
  --color-jet: #22333B;
  --color-smoke: #F2F4F3;
  --color-taupe: #A9927D;
  --color-stone: #5E503F;

  /* Glass effect colors */
  --color-glass-light: rgba(242, 244, 243, 0.08);
  --color-glass-dark: rgba(18, 18, 24, 0.6);

  /* Custom shadows */
  --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.12);
  --shadow-glass-hover: 0 12px 40px rgba(0, 0, 0, 0.16);
  --shadow-glow-taupe: 0 0 40px rgba(169, 146, 125, 0.15);

  /* Animation easings */
  --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Reference next/font CSS variable */
@theme inline {
  --font-serif: var(--font-fraunces);
}

/* Base styles */
body {
  background: var(--color-charcoal);
  color: var(--color-smoke);
}

/* Fraunces variable font axis utilities */
@layer utilities {
  .font-wonky {
    font-variation-settings: "WONK" 1;
  }

  .font-soft {
    font-variation-settings: "SOFT" 100;
  }

  .font-sharp {
    font-variation-settings: "SOFT" 0;
  }

  .font-editorial {
    font-variation-settings: "WONK" 1, "SOFT" 50;
    font-optical-sizing: auto;
  }
}

/* Glass utilities that work with dark theme */
@layer components {
  .glass-panel {
    background: var(--color-glass-light);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  .glass-nav {
    background: rgba(18, 18, 24, 0.8);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
  }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  ::before,
  ::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| framer-motion package | motion package | 2024-2025 | Same API, new package name, React 19 support |
| tailwind.config.js | @theme in CSS | Tailwind v4 (2024) | CSS-first configuration, no JS config needed |
| next.config.js fonts | next/font module | Next.js 13+ | Zero layout shift, automatic optimization |
| @media prefers-color-scheme | Class-based dark mode | Standard practice | More control, but Holmes is dark-only |
| Multiple font files | Variable fonts | Widespread adoption | Single file, all weights/styles, custom axes |

**Deprecated/outdated:**
- `framer-motion` package: Still works but `motion` is the current name
- `useViewportScroll`: Deprecated, use `useScroll` instead
- Tailwind's `tailwind.config.js`: Still supported but CSS `@theme` is preferred in v4
- `font-display: optional`: Use `swap` for better UX unless font is decorative

## Open Questions

Things that couldn't be fully resolved:

1. **React Flow vs Custom SVG for Workflow Diagram**
   - What we know: React Flow is powerful but may be overkill for a static diagram
   - What's unclear: Whether the workflow needs interactivity or just animation
   - Recommendation: Start with custom SVG + Motion. Only add React Flow if interactivity needed.

2. **Fraunces WONK at Small Sizes**
   - What we know: WONK axis auto-disables below 18px optical size for readability
   - What's unclear: Whether body text should use WONK or reserve it for headings
   - Recommendation: Use WONK for headings (h1-h3), disable for body text

3. **Motion version vs framer-motion**
   - What we know: `motion` is v12+, `framer-motion` is still published at v12+
   - What's unclear: Whether both packages are identical or motion has diverged
   - Recommendation: Use `motion` package as it's the current canonical name

## Sources

### Primary (HIGH confidence)
- [Tailwind CSS v4 Theme Variables](https://tailwindcss.com/docs/theme) - @theme directive, namespaces
- [Next.js Font Optimization](https://nextjs.org/docs/app/getting-started/fonts) - next/font patterns
- [Motion for React](https://motion.dev/docs/react) - Installation, hooks, patterns

### Secondary (MEDIUM confidence)
- [Motion Scroll Animations](https://motion.dev/docs/react-scroll-animations) - useScroll, useTransform, whileInView
- [Fraunces on Google Fonts](https://fonts.google.com/specimen/Fraunces) - Variable axes, weights
- [GitHub: Fraunces](https://github.com/undercasetype/Fraunces) - WONK, SOFT, opsz axis details
- [Next.js Server/Client Components](https://nextjs.org/docs/app/getting-started/server-and-client-components) - Component patterns

### Tertiary (LOW confidence)
- [Josh Comeau Backdrop Filter](https://www.joshwcomeau.com/css/backdrop-filter/) - Performance tips (from 2022, still relevant)
- Medium/Dev.to articles on Tailwind v4 theming - Community patterns

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH - Official docs verified for Motion, Tailwind v4, Next.js 16
- Architecture: HIGH - Based on official Next.js patterns and community best practices
- Pitfalls: MEDIUM - Mix of official docs and community experience
- Code Examples: HIGH - Patterns derived from official documentation

**Research date:** 2026-01-23
**Valid until:** 2026-03-23 (60 days - stable ecosystem, no major releases expected)
