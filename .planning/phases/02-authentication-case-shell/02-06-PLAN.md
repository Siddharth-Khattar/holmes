---
phase: 02-authentication-case-shell
plan: 06
type: execute
wave: 4
depends_on: ["02-02", "02-05"]
files_modified:
  - frontend/src/app/(app)/cases/page.tsx
  - frontend/src/app/(app)/cases/[id]/page.tsx
  - frontend/src/components/app/case-list.tsx
  - frontend/src/components/app/case-card.tsx
  - frontend/src/components/app/create-case-modal.tsx
  - frontend/src/components/app/empty-state.tsx
  - frontend/src/lib/validations/case.ts
  - frontend/src/types/case.ts
autonomous: true

must_haves:
  truths:
    - "User can see their list of cases"
    - "User can create a new case via modal"
    - "User can delete a case with confirmation"
    - "Empty state shows when no cases exist"
    - "Clicking a case navigates to case page"
  artifacts:
    - path: "frontend/src/app/(app)/cases/page.tsx"
      provides: "Case list page"
      contains: "CaseList"
    - path: "frontend/src/components/app/case-list.tsx"
      provides: "Case list with grid/list toggle"
      contains: "CaseCard"
    - path: "frontend/src/components/app/create-case-modal.tsx"
      provides: "Case creation dialog"
      contains: "CaseCreate"
    - path: "frontend/src/app/(app)/cases/[id]/page.tsx"
      provides: "Individual case page shell"
      contains: "case"
  key_links:
    - from: "frontend/src/components/app/case-list.tsx"
      to: "frontend/src/lib/api-client.ts"
      via: "API calls for cases"
      pattern: "api.get.*cases"
    - from: "frontend/src/components/app/create-case-modal.tsx"
      to: "frontend/src/lib/api-client.ts"
      via: "POST to create case"
      pattern: "api.post.*cases"
---

<objective>
Create the case list and creation UI for managing investigation cases.

Purpose: Users can view, create, and delete cases. Case page shell is empty until Phase 3 file upload.
Output: /cases page with list/grid view, creation modal, and /cases/[id] page shell.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-authentication-case-shell/02-CONTEXT.md
@.planning/phases/02-authentication-case-shell/02-RESEARCH.md
@DOCS/UI/DESIGN-SYSTEM.md
@frontend/src/lib/api-client.ts
@frontend/src/app/(app)/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create case types and validation schemas</name>
  <files>
    frontend/src/types/case.ts
    frontend/src/lib/validations/case.ts
  </files>
  <action>
1. Create `frontend/src/types/case.ts`:

```typescript
// ABOUTME: Case types matching backend schemas
// ABOUTME: Used for type-safe API responses

export type CaseStatus = "DRAFT" | "PROCESSING" | "READY" | "ERROR";
export type CaseType = "FRAUD" | "CORPORATE" | "CIVIL" | "CRIMINAL" | "OTHER";

export interface Case {
  id: string;
  name: string;
  description: string | null;
  type: CaseType;
  status: CaseStatus;
  file_count: number;
  created_at: string;
  updated_at: string;
}

export interface CaseListResponse {
  cases: Case[];
  total: number;
  page: number;
  per_page: number;
}

export interface CaseCreateInput {
  name: string;
  description?: string;
  type?: CaseType;
}
```

2. Create `frontend/src/lib/validations/case.ts`:

```typescript
// ABOUTME: Zod validation schemas for case forms
// ABOUTME: Matches backend validation rules

import { z } from "zod";

export const caseCreateSchema = z.object({
  name: z
    .string()
    .min(3, "Case name must be at least 3 characters")
    .max(100, "Case name must be less than 100 characters"),
  description: z
    .string()
    .max(5000, "Description must be less than 5000 characters")
    .optional()
    .or(z.literal("")),
});

export type CaseCreateFormData = z.infer<typeof caseCreateSchema>;
```
  </action>
  <verify>
    cd /Users/siddharth/Development/Hackathons/Gemini_3_2025/holmes/frontend && npx tsc --noEmit --skipLibCheck src/types/case.ts src/lib/validations/case.ts
  </verify>
  <done>Case types and validation schemas created</done>
</task>

<task type="auto">
  <name>Task 2: Create case list components</name>
  <files>
    frontend/src/components/app/case-card.tsx
    frontend/src/components/app/case-list.tsx
    frontend/src/components/app/empty-state.tsx
  </files>
  <action>
1. Create `frontend/src/components/app/empty-state.tsx`:
   - Generic empty state component
   - Props: icon, title, description, action (optional button)
   - Centered layout with muted styling
   - For cases: illustration + "No cases yet" + "Create your first case to get started" + New Case button

2. Create `frontend/src/components/app/case-card.tsx`:
   - Props: case data, viewMode (grid/list), onDelete callback
   - Grid mode: card layout with name, status badge, file count, last updated
   - List mode: row layout with same info in columns
   - Status badge colors:
     - DRAFT: gray/stone
     - PROCESSING: amber
     - READY: green
     - ERROR: red
   - Delete button (trash icon) with confirmation prompt
   - Click anywhere (except delete) navigates to /cases/[id]
   - Hover effect: subtle shadow lift

   Styling:
   - Card: bg-jet, border border-smoke/10, rounded-xl, p-4
   - Name: text-smoke, font-medium
   - Metadata: text-stone, text-sm

3. Create `frontend/src/components/app/case-list.tsx`:
   - Fetches cases from /api/cases using api client
   - Loading state with skeleton cards
   - Empty state when no cases
   - Toggle between grid and list view (state in component)
   - Sort dropdown: Name, Date Created, Last Updated, Status
   - "New Case" button that opens create modal
   - Pagination if total > per_page (simple next/prev for now)

   Layout:
   - Header: title "Cases" + view toggle + sort + New Case button
   - Grid: 3 columns on lg, 2 on md, 1 on sm
   - List: single column rows
  </action>
  <verify>
    cd /Users/siddharth/Development/Hackathons/Gemini_3_2025/holmes/frontend && ls src/components/app/case-*.tsx src/components/app/empty-state.tsx 2>/dev/null | wc -l | xargs test 3 -eq && echo "Case components created"
  </verify>
  <done>Case card, list, and empty state components created</done>
</task>

<task type="auto">
  <name>Task 3: Create case creation modal and pages</name>
  <files>
    frontend/src/components/app/create-case-modal.tsx
    frontend/src/app/(app)/cases/page.tsx
    frontend/src/app/(app)/cases/[id]/page.tsx
  </files>
  <action>
1. Create `frontend/src/components/app/create-case-modal.tsx`:
   - Modal/dialog component (can use liquid-glass-modal styling or simpler)
   - Props: open, onOpenChange, onSuccess callback
   - Form fields:
     - Name (required): text input
     - Description (optional): textarea with hint "This context helps the AI understand your case better"
   - Use react-hook-form with zodResolver(caseCreateSchema)
   - Submit: POST to /api/cases
   - On success: call onSuccess with new case, close modal, show toast
   - On error: show error message in form
   - Cancel button to close

   Styling:
   - Overlay: bg-charcoal/80 backdrop-blur
   - Modal: bg-jet, border-smoke/10, rounded-2xl, max-w-lg, p-6
   - Title: "Create New Case", text-smoke, font-medium
   - Inputs: same styling as auth forms

2. Create `frontend/src/app/(app)/cases/page.tsx`:

```typescript
// ABOUTME: Cases list page
// ABOUTME: Shows all user's cases with create/delete actions

"use client";

import { CaseList } from "@/components/app/case-list";

export default function CasesPage() {
  return (
    <div className="p-6 lg:p-8">
      <CaseList />
    </div>
  );
}
```

3. Create `frontend/src/app/(app)/cases/[id]/page.tsx`:
   - Shell page for individual case (Phase 3 will add file upload)
   - Fetch case data from /api/cases/{id}
   - Show case name as header
   - Empty state: "No files yet. Upload evidence to start your investigation."
   - This is a placeholder until Phase 3 file ingestion

```typescript
// ABOUTME: Individual case page shell
// ABOUTME: Will show case library and analysis in future phases

import { notFound } from "next/navigation";
import { api } from "@/lib/api-client";
import type { Case } from "@/types/case";

interface Props {
  params: Promise<{ id: string }>;
}

export default async function CasePage({ params }: Props) {
  const { id } = await params;

  let caseData: Case;
  try {
    caseData = await api.get<Case>(`/api/cases/${id}`);
  } catch {
    notFound();
  }

  return (
    <div className="p-6 lg:p-8">
      <h1 className="text-2xl font-medium text-smoke mb-6">{caseData.name}</h1>
      <div className="bg-jet/50 border border-smoke/10 rounded-xl p-8 text-center">
        <p className="text-stone">
          No files yet. Upload evidence to start your investigation.
        </p>
        <p className="text-stone text-sm mt-2">
          File upload coming in Phase 3.
        </p>
      </div>
    </div>
  );
}
```

Note: The case page uses server-side fetch. Ensure api-client works in server components, or create a server-side variant that uses cookies from headers.

Actually, for server components, we need to pass cookies. Create a helper or use fetch directly:

```typescript
import { cookies } from "next/headers";

async function getCase(id: string): Promise<Case | null> {
  const cookieStore = await cookies();
  const sessionCookie = cookieStore.get("better-auth.session_token");

  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/cases/${id}`, {
    headers: {
      Cookie: sessionCookie ? `better-auth.session_token=${sessionCookie.value}` : "",
    },
    cache: "no-store",
  });

  if (!res.ok) return null;
  return res.json();
}
```
  </action>
  <verify>
    cd /Users/siddharth/Development/Hackathons/Gemini_3_2025/holmes/frontend && test -f "src/app/(app)/cases/page.tsx" && test -f "src/app/(app)/cases/[id]/page.tsx" && test -f src/components/app/create-case-modal.tsx && echo "Case pages and modal created"
  </verify>
  <done>Case creation modal and pages created</done>
</task>

</tasks>

<verification>
1. All components created: ls src/components/app/case-*.tsx
2. Pages created: ls src/app/(app)/cases/
3. TypeScript compiles: npx tsc --noEmit --skipLibCheck
4. Dev server: /cases shows list (or empty state), modal creates case
</verification>

<success_criteria>
- /cases page shows user's cases (or empty state)
- Grid and list view toggle works
- Sort dropdown changes case order
- "New Case" button opens creation modal
- Modal validates input, creates case, redirects to new case page
- Case cards show name, status, file count, last updated
- Delete button shows confirmation, removes case from list
- /cases/[id] shows case name and placeholder for file upload
</success_criteria>

<output>
After completion, create `.planning/phases/02-authentication-case-shell/02-06-SUMMARY.md`
</output>
